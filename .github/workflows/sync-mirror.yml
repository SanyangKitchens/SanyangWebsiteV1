name: Mirror to Dubai (Raw Git)

on:
  push:
    branches: [ main ]

jobs:
  mirror-raw:
    runs-on: ubuntu-latest
    steps:
      # 1. Get the source code
      - name: Checkout
        uses: actions/checkout@v3
        with:
          fetch-depth: 0 # We need full history to mirror correctly

      # 2. Manual Push using the Token
      - name: Force Push to Dubai
        run: |
          # A. Configure a user so Git doesn't complain
          git config --global user.name "Mirror Bot"
          git config --global user.email "bot@sanyang.com"
          
          # B. Add the target remote using the Token explicitly
          # Syntax: https://USERNAME:TOKEN@github.com/ORG/REPO.git
          git remote add dubai https://SanyangKitchens:${{ secrets.MIRROR_TOKEN }}@github.com/SanyangKitchens/SanyangWebsiteDubai.git
          
          # C. Push main to the new remote
          git push dubai main --force